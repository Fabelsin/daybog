–ù–∞–ª–∞—à—Ç—É–π—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ –ø–∞—Ä–æ–ª—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é pam_pwquality, –∑
—É–º–æ–≤–∞–º–∏: –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ –¥–æ–≤–∂–∏–Ω–∞ ‚Äì 8 —Å–∏–º–≤–æ–ª—ñ–≤, –Ω–∞—è–≤–Ω—ñ—Å—Ç—å —Ü–∏—Ñ—Ä —ñ –≤–µ–ª–∏–∫–∏—Ö
–ª—ñ—Ç–µ—Ä. –ó–∞–±–æ—Ä–æ–Ω—ñ—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –æ—Å—Ç–∞–Ω–Ω—ñ—Ö 3 –ø–∞—Ä–æ–ª—ñ–≤. –ù–∞–ª–∞—à—Ç—É–π—Ç–µ
–±–ª–æ–∫—É–≤–∞–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–∞ 5 —Ö–≤–∏–ª–∏–Ω –ø—ñ—Å–ª—è 3-—Ö
–Ω–µ–≤–¥–∞–ª–∏—Ö —Å–ø—Ä–æ–± –≤—Ö–æ–¥—É. –°—Ç–≤–æ—Ä—ñ—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ user666 –Ω–∞–¥–∞–π—Ç–µ –π–æ–º—É
–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ñ –ø—Ä–∏–≤—ñ–ª–µ—ó, –Ω–∞–ª–∞—à—Ç—É–π—Ç–µ –∑–∞–±–æ—Ä–æ–Ω—É –≤—Ö–æ–¥—É —Ü—å–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑
–∫–æ–Ω—Å–æ–ª—ñ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ pam_securetty. –°—Ç–≤–æ—Ä—ñ—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ user13,
–æ–±–º–µ–∂—Ç–µ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ student –ø–æ —á–∞—Å—É –≤—Ö–æ–¥—É, —Ç—ñ–ª—å–∫–∏ –∑8:00 –¥–æ 18:00),
–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ pam_time. –î–æ–¥–∞–π—Ç–µ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–Ω—è
(pam_motd) –ø—Ä–∏ –≤—Ö–æ–¥—ñ –≤ —Å–∏—Å—Ç–µ–º—É.

üìÑ /etc/pam.d/common-password
(—Å–∫–ª–∞–¥–Ω—ñ—Å—Ç—å + —ñ—Å—Ç–æ—Ä—ñ—è –ø–∞—Ä–æ–ª—ñ–≤)
# PAM password configuration
password requisite pam_pwquality.so retry=3 minlen=8 dcredit=-1
ucredit=-1
password [success=1 default=ignore] pam_unix.so obscure use_authtok
sha512 remember=3
password required pam_deny.so
üìÑ /etc/pam.d/common-auth
‚ö†Ô∏è –ë–ï–ó pam_faillock ‚Äî —ñ–Ω–∞–∫—à–µ su –∑–ª–∞–º–∞—î—Ç—å—Å—è
# PAM authentication configuration
auth required pam_env.so
auth sufficient pam_unix.so nullok_secure
auth requisite pam_deny.so
auth required pam_permit.so
üìÑ /etc/pam.d/common-account
(pam_time –¥–ª—è student)
# PAM account configuration
account required pam_time.so
account required pam_unix.so
üìÑ /etc/pam.d/common-session
(pam_motd)
# PAM session configuration
session required pam_unix.so
session optional pam_motd.so motd=/run/motd.dynamic
session optional pam_motd.so noupdate
üìÑ /etc/pam.d/login
üëâ –ë–ª–æ–∫—É–≤–∞–Ω–Ω—è –¢–Ü–õ–¨–ö–ò user666 (–ª–æ–∫–∞–ª—å–Ω–∏–π –≤—Ö—ñ–¥)
# PAM configuration for login
auth [success=2 default=ignore] pam_succeed_if.so user = user666
auth required pam_faillock.so preauth silent audit deny=3
unlock_time=300
auth [default=die] pam_faillock.so authfail deny=3 unlock_time=300
auth sufficient pam_faillock.so authsucc
@include common-auth
@include common-account
@include common-session
@include common-password
üìÑ /etc/pam.d/sshd
üëâ –¢–ï –°–ê–ú–ï, –∞–ª–µ –¥–ª—è SSH
# PAM configuration for sshd
auth [success=2 default=ignore] pam_succeed_if.so user = user666
auth required pam_faillock.so preauth silent audit deny=3
unlock_time=300
auth [default=die] pam_faillock.so authfail deny=3 unlock_time=300
auth sufficient pam_faillock.so authsucc
@include common-auth
@include common-account
@include common-session
@include common-password
üìå –¢–µ–ø–µ—Ä:
‚óè ssh user666@host ‚Üí –±–ª–æ–∫—É—î—Ç—å—Å—è –ø—ñ—Å–ª—è 3 –ø–æ–º–∏–ª–æ–∫
‚óè ssh student@host ‚Üí –ù–ï –±–ª–æ–∫—É—î—Ç—å—Å—è
üìÑ /etc/security/time.conf
(–æ–±–º–µ–∂–µ–Ω–Ω—è —á–∞—Å—É –¥–ª—è student)
# service;tty;user;time
*;*;student;Al0800-1800
üìÑ /etc/pam.d/login (pam_securetty
–¥–ª—è root ‚Äî —è–∫ —É –≤–∏–º–æ–≥–∞—Ö)
–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Å—è, —â–æ —Ä—è–¥–æ–∫ —î —ñ –ù–ï –∑–∞–∫–æ–º–µ–Ω—Ç–æ–≤–∞–Ω–∏–π:
auth [success=ok ignore=ignore user_unknown=ignore default=bad]
pam_securetty.so
(—Ü–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç, –∑–∞–∑–≤–∏—á–∞–π —É–∂–µ —î)
üë§ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ
useradd -m user666
passwd user666
usermod -aG sudo user666
useradd -m student
passwd student
üîë SSH (–û–ë–û–í º–Ø–ó–ö–û–í–û)
–í /etc/ssh/sshd_config –ø–µ—Ä–µ–≤—ñ—Ä:
UsePAM yes
–ü–æ—Ç—ñ–º:
systemctl restart ssh
# –∞–±–æ
service ssh restart
‚úÖ –ü–ï–†–ï–í–Ü–†–ö–ê (–î–õ–Ø –ó–ê–•–ò–°–¢–£)
faillock --reset
‚ùå user666:
login user666
ssh user666@localhost
faillock --user user666
‚úÖ —î –∑–∞–ø–∏—Å–∏
‚úÖ student:
login student
ssh student@localhost
faillock --user student
‚úÖ –ø–æ—Ä–æ–∂–Ω—å–æ
‚úÖ su:
su student
su user666
‚úÖ –ø—Ä–∞—Ü—é—î
