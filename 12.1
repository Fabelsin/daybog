Дослідити, задокументувати та проаналізувати дії KMS-активатора при
активації MS Office.

Етап 0: Завантаження (На твій основний комп'ютер)
Знайди та завантаж ці файли (поки нічого не встановлюй, просто склади в одну папку):
1. VirtualBox та ISO-образ Windows 10 (вважаємо, що віртуалка у тебе вже стоїть).
2. Інсталятор MS Office (будь-який рік: 2016, 2019, 2021). Головне — щоб він був не
активований.
3. KMS-активатор (наприклад, KMSAuto Net або AAct). Увага: Твій антивірус буде
кричати. Додай папку завантаження у виключення або дозволь файл.
4. Wireshark (Windows Installer 64-bit).
5. RegShot (шукай на SourceForge, архів 7z або zip).
6. Sysinternals Suite (zip-архів з сайту Microsoft).
 Етап 1: Підготовка полігону (Всередині VirtualBox)
Запусти свою віртуальну машину з Windows. Усі подальші дії робимо ТІЛЬКИ ВСЕРЕДИНІ
ВІРТУАЛКИ.
1.1. Вимкнення "Захисника Windows" (Обов'язково!)
Він видалить активатор ще до початку тесту.
1. Натисни Пуск, введи: Захист від вірусів (Virus & threat protection) -> Enter.
2. Натисни "Керування налаштуваннями" (Manage settings).
3. Вимкніть перемикач "Захист у режимі реального часу" (Real-time protection) -> Вимк.
4. Вимкніть "Хмарний захист" -> Вимк.
1.2. Встановлення "Жертви"
1. Встанови MS Office.
2. Після встановлення відкрий Word. Якщо він попросить увійти в акаунт або ввести ключ
— просто закрий це вікно хрестиком.
3. Переконайся, що в меню File -> Account написано "Product Activation Required"
(Потрібна активація). Закрий Word.
1.3. Розгортання інструментів
1. Перетягни файли інструментів у вікно віртуалки (або скачай їх через браузер всередині
віртуалки).
2. Wireshark: Запусти інсталятор. Тисни Next -> I Agree -> Next -> Next... Погоджуйся на
встановлення Npcap (це важливо!). Перезавантаж віртуалку, якщо попросить.
3. Sysinternals: Розпакуй архів у папку C:\Tools\Sysinternals.
4. RegShot: Розпакуй архів у папку C:\Tools\Regshot.
5. Активатор: Розпакуй на Робочий стіл (пароль архіву зазвичай 1234 або windows). НЕ
ЗАПУСКАЙ ЙОГО ПОКИ ЩО!
 Етап 2: Точка неповернення
1. Згорни вікна всередині віртуалки.
2. У верхньому меню вікна VirtualBox натисни: Machine (Машина) -> Take Snapshot
(Зробити знімок).
3. Ім'я: Clean State. Опис: Перед запуском вірусу.
4. Натисни OK.
Тепер, якщо ти все зламаєш, ти зможеш повернутися сюди за 10 секунд.
 Етап 3: Налаштування пасток (Перед запуском)
Тепер ми розставляємо "камери спостереження".
3.1. RegShot (Фотографуємо реєстр "ДО")
1. Відкрий папку C:\Tools\Regshot.
2. Запусти Regshot-x64-ANSI.exe (або просто Regshot.exe).
3. Натисни кнопку 1st shot (Перший знімок).
4. У меню вибери Shot (Знімок).
5. Зачекай (курсор перетвориться на пісочний годинник). Коли цифри внизу перестануть
бігти — готово. Не закривай програму!
3.2. Wireshark (Слухаємо мережу)
1. Запусти Wireshark.
2. На головному екрані ти побачиш список адаптерів (хвилясті лінії).
o Якщо є "Adapter for loopback traffic capture" — вибери його (клацни двічі). Це
ідеально для KMS, бо він працює локально.
o Якщо немає — вибери "Ethernet" (або той, де є активність/графік).
3. Зверху в рядку фільтра (Apply a display filter) введи: tcp.port == 1688 (Це стандартний
порт активації KMS. Якщо ми не введемо фільтр, ми потонемо у смітті).
4. Натисни Enter. Поки що екран буде порожнім. Це нормально.
3.3. Process Monitor (Стежимо за файлами)
1. Відкрий папку C:\Tools\Sysinternals.
2. Запусти Procmon.exe (або Procmon64.exe).
3. Він відразу почне показувати купу рядків. Нам це поки не треба.
4. Натисни Ctrl + E (це зупинить запис, іконка лупи зверху стане перекресленою).
5. Натисни Ctrl + X (це очистить екран).
Стан готовності:
• RegShot: Зробив 1-й знімок, відкрито.
• Wireshark: Запущено, фільтр стоїть, запис іде (синя кнопка неактивна, червона
активна).
• ProcMon: Запущено, запис зупинено (Ctrl+E), список пустий.
• Активатор: Лежить на столі.
 Етап 4: Атака!
Дій швидко.
1. Перейди у ProcMon. Натисни Ctrl + E (Почати запис).
2. Одразу запусти KMS-активатор (права кнопка -> Run as Administrator / Запуск від імені
адміністратора).
3. В інтерфейсі активатора натисни кнопку Activate Office.
4. Дивись на консоль активатора. Він напише щось типу "Installing driver...", "Hooking...",
"Product successfully activated".
5. Як тільки побачиш повідомлення про успіх — Закрий активатор.
 Етап 5: Збір доказів
Зупиняємо запис, поки логи не стали гігантськими.
1. ProcMon: Натисни Ctrl + E (Зупинити запис).
2. Wireshark: Натисни Червоний квадрат (Stop capturing) у верхньому лівому куті.
3. RegShot:
o Натисни кнопку 2nd shot (Другий знімок).
o Вибери Shot. Зачекай.
o Коли закінчить, стане активною кнопка Compare (Порівняти). Натисни її.
o Відкриється Блокнот або браузер зі звітом. Збережи цей файл як
Registry_Report.txt.
 Етап 6: Аналіз (Де шукати компромат для звіту)
Тепер у тебе є три джерела даних. Ось що ти там шукаєш:
А. Аналіз реєстру (Файл RegShot)
Прокрути звіт (він довгий). Шукай розділ "Values modified" (Змінені значення) або "Keys
added". Шукай очіма слово Office або Protection.
• Золота знахідка: Шлях: HKLM\SOFTWARE\Microsoft\OfficeSoftwareProtectionPlatform
Параметр: KeyManagementServiceName Значення: Було пусте, стало 127.0.0.1 або
10.x.x.x. Висновок для звіту: Активатор змінив адресу сервера перевірки ліцензії на
локальну адресу, щоб емулювати сервер на цьому ж комп'ютері.
Б. Аналіз мережі (Wireshark)
Подивись на пакети.
• Ти маєш бачити рядки з протоколом TCP або DCERPC.
• Source: 127.0.0.1, Destination: 127.0.0.1.
• Info: Synchronize (SYN) на порт 1688. Висновок для звіту: Відбулося з'єднання з
локальним KMS-сервером (емулятором) через порт 1688.
В. Аналіз файлів (Process Monitor)
Тут мільйон рядків. Треба фільтрувати.
1. Натисни Ctrl + L (Filter).
2. Налаштуй так:
o Process Name contains [назва_твого_активатора] (наприклад, KMS).
o Натисни Add, потім OK.
3. Тепер дивись на стовпчик Operation. Шукай:
o CreateFile або WriteFile.
o Дивись на стовпчик Path.
o Що шукати: Чи створював він файли .exe або .dll у папці C:\Windows? Або .vbs у
папці AppData\Local\Temp? Висновок для звіту: Активатор розпакував
тимчасові скрипти та драйвер (наприклад, tap0901.sys) для створення
віртуальної мережі.
