Налаштуйте двофакторну автентифікацію при вході з консолі та через
ssh. Перенесіть домашню директорію користувача user13 в /test/user та
зробіть цю директорію кореневою для цього користувача. Показати, які
типи namespaces вже існують у системі? Запустіть новий процес htop із
власним UTS-простором.

Етап 1. Встановлення ПЗ та генерація ключів
1. Встановлення модуля 2FA та утиліти htop
Bash
apt update && apt install libpam-google-authenticator htop -y
	•	Що робить: Оновлює списки пакетів та встановлює бібліотеку Google Authenticator (для 2FA) і диспетчер завдань htop (для завдання з namespaces).
	•	Синтаксис: && — виконати другу команду, тільки якщо перша успішна; -y — автоматично погоджуватися на встановлення.
2. Генерація токена 2FA для користувача (Виконується для кожного користувача, якого треба захистити, наприклад root або user13)
Bash
google-authenticator
	•	Що робить: Запускає майстер створення секретного ключа, виводить QR-код для додатка на телефоні та створює файл налаштувань у домашній директорії (.google_authenticator).
	•	Синтаксис: Інтерактивна утиліта без додаткових ключів.

Етап 2. Налаштування користувача та Chroot (ізоляція директорії)
3. Створення нової структури тек
Bash
mkdir -p /test
	•	Що робить: Створює батьківську директорію /test.
	•	Синтаксис: -p (parents) — не видає помилку, якщо папка вже існує, і створює проміжні папки за потреби.
4. Перенесення домашньої директорії користувача
Bash
useradd -m -s /bin/bash user13
usermod -d /test/user -m user13
	•	Що робить: Змінює домашню директорію користувача user13 на нову адресу та фізично переносить туди файли.
	•	Синтаксис: -d (home dir) — задає новий шлях; -m (move) — переміщує вміст зі старої папки в нову.
5. Призначення прав для Chroot (зробити директорію кореневою)
Bash
chown root:root /test/user
chmod 755 /test/user
	•	Що робить: Передає права власності на папку користувачу root. Це обов'язкова вимога безпеки SSH для роботи функції ChrootDirectory.
	•	Синтаксис: chown (change owner) змінює власника; chmod 755 дає повні права власнику, а іншим — тільки читання/виконання.

Етап 3. Налаштування SSH (Базове + 2FA + Chroot)
6. Редагування конфігурації SSH Відкриваємо файл: nano /etc/ssh/sshd_config. Вносимо (або перевіряємо) наступні зміни:
Plaintext
# Базові налаштування
PermitRootLogin yes
PasswordAuthentication yes

# Налаштування для 2FA (інтерактивний ввід)
KbdInteractiveAuthentication yes
UsePAM yes
AuthenticationMethods keyboard-interactive

# Налаштування Chroot для user13
Match User user13
    ChrootDirectory /test/user
	•	Пояснення параметрів:
	•	PermitRootLogin yes: Дозволяє вхід користувачу root.
	•	KbdInteractiveAuthentication yes: Дозволяє серверу питати у користувача додаткові дані (код 2FA) через клавіатуру.
	•	AuthenticationMethods keyboard-interactive: Вказує, що для входу потрібен пароль + код (і не вимагає public key, щоб уникнути помилок).
	•	Match User user13: Застосовує наступні команди тільки до цього користувача.
	•	ChrootDirectory: "Замикає" користувача у вказаній папці при вході.
7. Перезапуск служби SSH
Bash
systemctl restart ssh
	•	Що робить: Застосовує нові налаштування без перезавантаження сервера.

Етап 4. Підключення 2FA до системи (PAM)
8. Налаштування PAM для SSH Відкриваємо файл: nano /etc/pam.d/sshd. Додаємо в кінець:
Plaintext
auth required pam_google_authenticator.so
	•	Що робить: Зобов'язує службу SSH звертатися до модуля Google Authenticator для перевірки коду при вході.
9. Налаштування PAM для локальної консолі Відкриваємо файл: nano /etc/pam.d/login. Додаємо в кінець:
Plaintext
auth required pam_google_authenticator.so
	•	Що робить: Зобов'язує систему вимагати код 2FA навіть при фізичному вході через монітор/клавіатуру сервера.

Етап 5. Робота з Namespaces (Простори імен)
10. Перегляд існуючих namespaces
Bash
lsns
	•	Що робить: Виводить список усіх активних просторів імен (User, Net, Mnt, UTS тощо) та процесів, які їх використовують.
	•	Синтаксис: Утиліта з пакету util-linux.
11. Запуск процесу htop у власному UTS-просторі
Bash
unshare --uts --fork htop
	•	Що робить: Створює ізольоване середовище (namespace) для імені хоста і запускає в ньому програму htop.
	•	Синтаксис:
	•	--uts: Створити новий UTS namespace (дозволяє мати окремий hostname).
	•	--fork: Запустити програму як окремий дочірній процес (важливо для коректної роботи графіки htop).
	•	htop: Сама команда для запуску.

Готово! Це повний цикл налаштування, який виконує всі умови завдання.
Візуальна перевірка (опціонально): Якщо ви хочете переконатися, що це працює, краще запустити bash, змінити hostname і запустити htop звідти:
	•	unshare --uts --fork /bin/bash
	•	hostname test-namespace
	•	hostname
	•	exit
	•	hostname
